<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Tracking - Campus Mental Health Support</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- Mobile Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <!-- Mobile Sidebar -->
    <div class="mobile-sidebar" id="mobile-sidebar">
        <div class="sidebar-header">
            <a href="/dashboard" class="logo">Campus Support</a>
        </div>
        <nav class="sidebar-nav">
            <a href="/dashboard">ğŸ“Š Dashboard</a>
            <a href="/mood" class="active">ğŸ˜Š Mood Tracking</a>
            <a href="/quizzes">ğŸ“ Quizzes</a>
            <a href="/consultation">ğŸ’¬ Consultation</a>
            <button hx-post="/logout" hx-target="body" class="btn-secondary">ğŸšª Logout</button>
        </nav>
    </div>
    
    <nav class="navbar">
        <div class="container">
            <button class="menu-toggle" id="menu-toggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <a href="/dashboard" class="logo">Campus Support</a>
            <div class="nav-links">
                <a href="/dashboard">Dashboard</a>
                <a href="/mood">Mood Tracking</a>
                <a href="/quizzes">Quizzes</a>
                <a href="/consultation">Consultation</a>
                <button hx-post="/logout" hx-target="body" class="btn-secondary">Logout</button>
            </div>
        </div>
    </nav>
    
    <main class="container">
        <div class="dashboard-header">
            <h1>Daily Mood Tracking</h1>
            <p>Track your mood daily and get personalized recommendations</p>
        </div>

        <!-- Daily Quote -->
        <div id="daily-quote-container" class="card quote-card">
            <h2>ğŸ’­ Today's Motivational Quote</h2>
            <div id="daily-quote">
                <div class="loading">Loading your daily quote...</div>
            </div>
        </div>

        <!-- Mood Entry Form -->
        <div class="card">
            <h2>How are you feeling today?</h2>
            <form hx-post="/api/mood" 
                  hx-target="#mood-result" 
                  hx-swap="innerHTML"
                  hx-on::after-request="if(event.detail.xhr.status === 200) { htmx.ajax('GET', '/api/mood/history', {target: '#mood-history', swap: 'innerHTML'}); htmx.ajax('GET', '/api/mood/quote', {target: '#daily-quote', swap: 'innerHTML'}); }">
                <div class="form-group">
                    <label>Mood Type</label>
                    <select name="mood_type" required>
                        <option value="happy">ğŸ˜Š Happy</option>
                        <option value="sad">ğŸ˜¢ Sad</option>
                        <option value="anxious">ğŸ˜° Anxious</option>
                        <option value="stressed">ğŸ˜¤ Stressed</option>
                        <option value="calm">ğŸ˜Œ Calm</option>
                        <option value="energetic">âš¡ Energetic</option>
                        <option value="tired">ğŸ˜´ Tired</option>
                        <option value="frustrated">ğŸ˜  Frustrated</option>
                        <option value="neutral">ğŸ˜ Neutral</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Mood Level (1-10)</label>
                    <input type="range" name="score" min="1" max="10" value="5" 
                           oninput="document.getElementById('score-display').textContent = this.value" required>
                    <div class="score-display">
                        <span id="score-display">5</span>/10
                    </div>
                </div>

                <div class="form-group">
                    <label>Notes (Optional)</label>
                    <textarea name="notes" rows="3" placeholder="How are you feeling? What's on your mind?"></textarea>
                </div>

                <button type="submit" class="btn-primary">Record Mood</button>
            </form>
            <div id="mood-result"></div>
        </div>

        <!-- Mood History -->
        <div class="card">
            <h2>Your Mood History</h2>
            <div id="mood-history">
                <div class="loading">Loading your mood history...</div>
            </div>
        </div>
    </main>

    <script>
        // Mobile sidebar toggle
        (function() {
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('mobile-sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            
            function toggleSidebar() {
                const isActive = sidebar.classList.contains('active');
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
                menuToggle.classList.toggle('active');
                document.body.classList.toggle('sidebar-open');
            }
            
            if (menuToggle) {
                menuToggle.addEventListener('click', toggleSidebar);
            }
            
            if (overlay) {
                overlay.addEventListener('click', toggleSidebar);
            }
            
            // Close sidebar when clicking on a link
            const sidebarLinks = sidebar.querySelectorAll('.sidebar-nav a');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function() {
                    // Don't close for logout button (handled by HTMX)
                    if (!this.classList.contains('btn-secondary')) {
                        setTimeout(toggleSidebar, 300);
                    }
                });
            });
        })();
        
        // Load quote and history on page load
        document.addEventListener('DOMContentLoaded', function() {
            htmx.ajax('GET', '/api/mood/quote', {
                target: '#daily-quote',
                swap: 'innerHTML'
            });
            htmx.ajax('GET', '/api/mood/history', {
                target: '#mood-history',
                swap: 'innerHTML'
            });
        });
    </script>
</body>
</html>

